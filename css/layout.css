/* ============================================================
   LAYOUT.CSS — Application Grid & Component Layout System
   Polly Prediction Partners v0.03.01

   Viewport target: 1920 × 944 px (16:9-ish cockpit panel)
   All sizing uses CSS Grid with fixed gutters and named areas.

   Grid anatomy
   ─────────────
   ┌───────────────────────────────────────────────┐
   │  HEADER BAR          (full width, 78px)        │
   ├───────────────────────────────────────────────┤
   │  NAV BAR             (full width, 39px)        │
   ├──────────┬──────────────────────┬─────────────┤
   │  LEFT    │                      │  RIGHT       │
   │  SIDEBAR │    MAIN STAGE        │  SIDEBAR     │
   │  (320px) │    (fluid)           │  (320px)     │
   ├──────────┴──────────────────────┴─────────────┤
   │  BOTTOM BAR (4/6)    │  ACTION BAR (2/6) 157px │
   └─────────────────────────────────────────────── ┘

   Gutter: 18px between every region.

   Token dependencies (tokens.css):
     --layout-gutter, --layout-radius, --layout-radius-lg,
     --layout-bezel-inner, --layout-bezel-outer,
     --color-bg-canvas, --color-bg-surface,
     --color-fg-default, --color-fg-muted, --color-fg-strong,
     --color-border-default, --color-border-muted, --color-border-focus,
     --font-sans, --font-mono,
     --font-size-xs … --font-size-2xl,
     --transition-fast, --transition-base, --transition-slow
   ============================================================ */


/* ============================================================
   SECTION 1 — RESET & BASE
   ============================================================ */

*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html,
body {
  width: 100%;
  height: 100%;
  overflow: hidden; /* cockpit is fixed-size; no scroll on root */
}

body {
  background: var(--color-bg-canvas);
  color: var(--color-fg-default);
  font-family: var(--font-sans);
  font-size: var(--font-size-base, 13px);
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  /* Smooth theme/mode transitions */
  transition:
    background-color var(--transition-slow),
    color            var(--transition-slow),
    border-color     var(--transition-slow);
}


/* ============================================================
   SECTION 2 — APP ROOT GRID
   ============================================================ */

.app-root {
  /* Exact viewport coverage */
  width: 100vw;
  height: 100vh;
  overflow: hidden;

  /* Grid */
  display: grid;
  padding: var(--layout-gutter, 18px);
  gap: var(--layout-gutter, 18px);
  grid-template-columns: 320px 1fr 320px;
  grid-template-rows: 78px 39px 1fr 157px;
  grid-template-areas:
    "header    header    header"
    "navbar    navbar    navbar"
    "lsidebar  main      rsidebar"
    "bottombar bottombar actionbar";

  box-sizing: border-box;
  background: var(--color-bg-canvas);
  color: var(--color-fg-default);
  font-family: var(--font-sans);
  position: relative; /* stacking context for overlays */

  /* Smooth theme changes */
  transition:
    background-color var(--transition-slow),
    color            var(--transition-slow);
}

/* All direct-child regions sit above the flood overlay (z-index: 0) */
.app-root > .region {
  position: relative;
  z-index: 1;
}

/* ============================================================
   STUDIO LAYOUT OVERRIDES
   Trade and Fly studios: sidebars phase out, main expands to
   full width giving maximum space to the live data interface.
   ============================================================ */

/* Trade studio: hide sidebars, main spans all three columns */
.app-root[data-active-studio="trade"],
.app-root[data-active-studio="fly"] {
  grid-template-columns: 0 1fr 0;
  grid-template-areas:
    "header    header    header"
    "navbar    navbar    navbar"
    "main      main      main"
    "bottombar bottombar actionbar";
}

.app-root[data-active-studio="trade"] .region-lsidebar,
.app-root[data-active-studio="trade"] .region-rsidebar,
.app-root[data-active-studio="fly"]   .region-lsidebar,
.app-root[data-active-studio="fly"]   .region-rsidebar {
  display: none;
}


/* ============================================================
   SECTION 3 — REGION BASE
   Shared structural styles for every named grid region.
   ============================================================ */

.region {
  background: var(--color-bg-surface);
  border: 1px solid var(--color-border-default);
  border-radius: var(--layout-radius, 6px);
  overflow: hidden;
  position: relative;

  /* Smooth theme/glow transitions */
  transition:
    background-color var(--transition-slow),
    border-color     var(--transition-slow),
    box-shadow       var(--transition-slow);
}


/* ============================================================
   SECTION 4 — NAMED REGION PLACEMENTS
   ============================================================ */

/* 1. Header bar ─ branding, global controls */
.region-header {
  grid-area: header;
  display: flex;
  align-items: center;
  padding: 0 var(--layout-bezel-outer, 12px);
  gap: 12px;
  overflow: hidden;
}

/* 2. Nav bar ─ tab navigation, studio selector */
.region-navbar {
  grid-area: navbar;
  display: flex;
  align-items: stretch;
  padding: 0 var(--layout-bezel-outer, 12px);
  gap: 8px;
  overflow: hidden;
}

/* 3. Left sidebar ─ filters, instrument list */
.region-lsidebar {
  grid-area: lsidebar;
  overflow-y: auto;
  overflow-x: hidden;
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: var(--layout-bezel-outer, 12px);
}

/* 4. Main stage ─ primary content / charts */
.region-main {
  grid-area: main;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* 5. Right sidebar ─ context panel, order book */
.region-rsidebar {
  grid-area: rsidebar;
  overflow-y: auto;
  overflow-x: hidden;
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: var(--layout-bezel-outer, 12px);
}

/* 6. Action bar ─ order entry, quick actions */
.region-actionbar {
  grid-area: actionbar;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  padding: var(--layout-bezel-outer, 12px);
  gap: 8px;
}

/* 7. Bottom bar ─ ticker tape, position summary */
.region-bottombar {
  grid-area: bottombar;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  padding: var(--layout-bezel-inner, 6px) var(--layout-bezel-outer, 12px);
}

/* Horizontal scroll container that holds all bottom bar cards */
.bottombar-cards-container {
  display: flex;
  gap: 12px;
  flex: 1;
  min-height: 0;
  overflow-x: auto;
  overflow-y: hidden;
  align-items: stretch;
}

/* ============================================================
   SECTION 5 — REGION HEADER / PANEL LABEL
   Engraved nameplate mounted at the top of each region.
   ============================================================ */

.region-panel-label {
  /* Etched look: tight caps, muted color, subtle deboss shadows */
  font-size: var(--font-size-xs, 10px);
  font-weight: 800;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: var(--color-fg-muted);
  text-shadow:
    0  1px 0 rgba(255, 255, 255, 0.1),
    0 -1px 0 rgba(0, 0, 0, 0.25);
  user-select: none;
  white-space: nowrap;
  padding: 0 2px;
  flex-shrink: 0;
}

/* Full-width label bar pinned to the top of a region */
.region-label-bar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px var(--layout-bezel-outer, 12px);
  border-bottom: 1px solid var(--color-border-muted);
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.04) 0%,
    transparent 100%
  );
  flex-shrink: 0;
  transition: border-color var(--transition-slow);
}

/* Separator pip between label segments */
.region-label-pip {
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--color-border-default);
  flex-shrink: 0;
}


/* ============================================================
   SECTION 6 — BEZEL SYSTEM
   Nested padding layers that simulate instrument panel frames.
   ============================================================ */

/* Outer bezel — main structural frame */
.bezel-outer {
  padding: var(--layout-bezel-outer, 12px);
}

/* Inner bezel — close-fitting instrument surround */
.bezel-inner {
  padding: var(--layout-bezel-inner, 6px);
}

/* Combined bezel wrapper (outer wraps inner) */
.bezel {
  padding: var(--layout-bezel-outer, 12px);
}
.bezel > .bezel-inner {
  padding: var(--layout-bezel-inner, 6px);
}

/* Deep bezel — sunken instrument well */
.bezel-deep {
  padding: var(--layout-bezel-outer, 12px);
  background: rgba(0, 0, 0, 0.08);
  border-radius: calc(var(--layout-radius, 6px) - 2px);
  box-shadow:
    inset 0 2px 6px rgba(0, 0, 0, 0.2),
    inset 0 1px 2px rgba(0, 0, 0, 0.15);
}


/* ============================================================
   SECTION 7 — CARD
   Content containers within regions.
   ============================================================ */

.card {
  background: var(--color-bg-surface);
  border: 1px solid var(--color-border-default);
  border-radius: var(--layout-radius, 6px);
  padding: 12px;
  transition:
    border-color     var(--transition-base),
    background-color var(--transition-slow),
    box-shadow       var(--transition-slow);
}

.card:hover {
  border-color: var(--color-border-focus);
}

/* Compact card variant */
.card-sm {
  padding: 8px;
  border-radius: calc(var(--layout-radius, 6px) - 2px);
}

/* Inset / recessed card (data well) */
.card-inset {
  background: rgba(0, 0, 0, 0.06);
  border-color: var(--color-border-muted);
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.12);
}

/* Flat card (no border) */
.card-flat {
  border-color: transparent;
  background: transparent;
}

/* Card header */
.card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 10px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--color-border-muted);
}

/* Card body (auto-grows) */
.card-body {
  flex: 1 1 auto;
}

/* Card footer */
.card-footer {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 10px;
  padding-top: 8px;
  border-top: 1px solid var(--color-border-muted);
}


/* ============================================================
   SECTION 8 — STUDIO CONTENT AREAS
   Full-height/width flex containers for each studio mode.
   ============================================================ */

/* Root container that fills its parent region completely */
.studio-content {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

/* DESIGN studio — layout/theme configuration */
.studio-design {
  display: flex;
  flex-direction: column;
  gap: var(--layout-gutter, 18px);
  padding: var(--layout-bezel-outer, 12px);
  overflow-y: auto;
  flex: 1 1 auto;
}

/* TRADE studio — market/prediction interface */
.studio-trade {
  display: grid;
  grid-template-columns: 1fr 280px;
  grid-template-rows: 1fr auto;
  gap: var(--layout-gutter, 18px);
  padding: var(--layout-bezel-outer, 12px);
  overflow: hidden;
  flex: 1 1 auto;
}

/* FLY studio — live/execution mode */
.studio-fly {
  display: flex;
  flex-direction: column;
  padding: var(--layout-bezel-outer, 12px);
  gap: var(--layout-gutter, 18px);
  overflow: hidden;
  flex: 1 1 auto;
}

/* Studio visibility controlled by data-studio attribute */
.studio-content [data-studio-panel] {
  display: none;
}
.studio-content [data-studio-panel].studio-active,
[data-studio="design"]  .studio-design,
[data-studio="trade"]   .studio-trade,
[data-studio="fly"]     .studio-fly {
  display: flex;
}


/* ============================================================
   SECTION 9 — SCROLLBAR STYLES
   Scoped to overflow-capable containers; avoids touching
   elements that should never show a custom scrollbar.
   ============================================================ */

/* Firefox — scoped to scrollable containers */
.region,
.region-lsidebar,
.region-rsidebar,
.region-main,
.region-bottombar,
.studio-design,
.terminal-display,
.data-log,
.overflow-auto,
.overflow-y-auto,
.overflow-x-auto {
  scrollbar-width: thin;
  scrollbar-color: var(--color-border-default) transparent;
}

/* WebKit */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--color-border-default);
  border-radius: 3px;
  border: 1px solid transparent;
  background-clip: content-box;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-border-focus);
  background-clip: content-box;
}

::-webkit-scrollbar-corner {
  background: transparent;
}


/* ============================================================
   SECTION 10 — PRECISION RULER OVERLAYS
   Fixed 18px rulers along the top and left edges — activated
   by a debug/design mode toggle.
   ============================================================ */

.precision-ruler-x,
.precision-ruler-y {
  position: fixed;
  background: repeating-linear-gradient(
    90deg,
    var(--color-border-muted) 0px,
    var(--color-border-muted) 1px,
    transparent 1px,
    transparent 10px
  );
  z-index: 9000;
  pointer-events: none;
  opacity: 0;
  transition: opacity var(--transition-base);
}

/* Show rulers when design overlay is active */
.precision-rulers-visible .precision-ruler-x,
.precision-rulers-visible .precision-ruler-y,
[data-rulers="true"] .precision-ruler-x,
[data-rulers="true"] .precision-ruler-y {
  opacity: 1;
}

/* Horizontal ruler — sits at the very top of the viewport */
.precision-ruler-x {
  top: 0;
  left: 18px; /* offset past the vertical ruler */
  right: 0;
  height: 18px;
  background: repeating-linear-gradient(
    90deg,
    rgba(255, 200, 0, 0.3) 0px,
    rgba(255, 200, 0, 0.3) 1px,
    transparent 1px,
    transparent 10px
  );
  border-bottom: 1px solid rgba(255, 200, 0, 0.4);
}

/* Vertical ruler — sits at the very left of the viewport */
.precision-ruler-y {
  top: 18px; /* offset below horizontal ruler */
  left: 0;
  bottom: 0;
  width: 18px;
  background: repeating-linear-gradient(
    180deg,
    rgba(255, 200, 0, 0.3) 0px,
    rgba(255, 200, 0, 0.3) 1px,
    transparent 1px,
    transparent 10px
  );
  border-right: 1px solid rgba(255, 200, 0, 0.4);
}

/* Corner square where rulers meet */
.precision-ruler-corner {
  position: fixed;
  top: 0;
  left: 0;
  width: 18px;
  height: 18px;
  background: rgba(255, 200, 0, 0.15);
  border-right: 1px solid rgba(255, 200, 0, 0.4);
  border-bottom: 1px solid rgba(255, 200, 0, 0.4);
  z-index: 9001;
  pointer-events: none;
  opacity: 0;
  transition: opacity var(--transition-base);
}
.precision-rulers-visible .precision-ruler-corner,
[data-rulers="true"] .precision-ruler-corner {
  opacity: 1;
}


/* ============================================================
   SECTION 11 — PRECISION GRID OVERLAY
   Full-viewport grid for layout verification. Toggled by
   data-grid="true" on a parent or .precision-grid-visible.
   ============================================================ */

.precision-grid-overlay {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 100;
  opacity: 0;
  transition: opacity var(--transition-base);

  /* 18px baseline grid */
  background-image:
    linear-gradient(rgba(255, 0, 255, 0.05) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255, 0, 255, 0.05) 1px, transparent 1px);
  background-size: 18px 18px;
  background-position: 18px 18px;
}

.precision-grid-overlay.grid-visible,
.precision-grid-visible .precision-grid-overlay,
[data-grid="true"] .precision-grid-overlay {
  opacity: 1;
}

/* Column guide lines (optional 320px column markers) */
.precision-grid-overlay::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(90deg, rgba(0, 255, 255, 0.06) 1px, transparent 1px);
  background-size: 320px 100%;
  background-position: 18px 0;
  pointer-events: none;
}


/* ============================================================
   SECTION 12 — TYPOGRAPHY UTILITIES
   ============================================================ */

/* Etched / debossed physical label */
.label-etched {
  font-size: var(--font-size-sm, 11px);
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--color-fg-muted);
  text-shadow:
     0  1px 0 rgba(255, 255, 255, 0.15),
     0 -1px 0 rgba(0, 0, 0, 0.2);
  user-select: none;
}

/* Raised / embossed physical label */
.label-embossed {
  font-size: var(--font-size-sm, 11px);
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--color-fg-strong);
  text-shadow:
     0  1px 0 rgba(255, 255, 255, 0.3),
     0 -1px 0 rgba(0, 0, 0, 0.3);
  user-select: none;
}

/* Monospace data value */
.value-mono {
  font-family: var(--font-mono);
  font-size: var(--font-size-sm, 11px);
  letter-spacing: 0.04em;
  tabular-nums: auto;
  font-variant-numeric: tabular-nums;
}

/* Ticker / scrolling data */
.value-ticker {
  font-family: var(--font-mono);
  font-size: var(--font-size-base, 13px);
  font-weight: 600;
  letter-spacing: 0.06em;
  font-variant-numeric: tabular-nums;
}

/* Positive / negative value coloring */
.value-positive { color: var(--color-state-success); }
.value-negative { color: var(--color-state-error);   }
.value-neutral  { color: var(--color-fg-muted);      }


/* ============================================================
   SECTION 13 — INDICATOR LIGHTS
   Glowing status dots — panel indicator lamps.
   ============================================================ */

.indicator-light {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--indicator-color, currentColor);
  color: var(--indicator-color, currentColor);
  flex-shrink: 0;
  position: relative;
  transition:
    background-color var(--transition-base),
    box-shadow       var(--transition-base);
}

/* Pulsed ring for "active" state */
.indicator-light::after {
  content: '';
  position: absolute;
  inset: -3px;
  border-radius: 50%;
  border: 1px solid currentColor;
  opacity: 0;
  transition: opacity var(--transition-base);
}

/* Color states */
.indicator-light-green  { color: var(--color-state-success); }
.indicator-light-amber  { color: var(--color-state-warning); }
.indicator-light-red    { color: var(--color-state-error);   }
.indicator-light-blue   { color: var(--color-state-info);    }
.indicator-light-white  { color: #ffffff; }

/* ON — full glow */
.indicator-light.light-on {
  box-shadow:
    0 0 4px 1px currentColor,
    0 0 10px 2px currentColor;
}
.indicator-light.light-on::after {
  opacity: 0.35;
}

/* OFF — dimmed, no glow */
.indicator-light.light-off {
  opacity: 0.25;
  box-shadow: none;
}

/* BLINK animation */
@keyframes blink-lamp {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0.15; }
}
.indicator-light.light-blink {
  animation: blink-lamp 1s ease-in-out infinite;
}

/* Large lamp variant */
.indicator-light-lg {
  width: 12px;
  height: 12px;
}
.indicator-light-lg::after {
  inset: -4px;
}


/* ============================================================
   SECTION 14 — BUTTON STYLES
   ============================================================ */

/* Base button */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 5px 12px;
  font-family: var(--font-sans);
  font-size: var(--font-size-sm, 11px);
  font-weight: 600;
  letter-spacing: 0.04em;
  line-height: 1;
  text-decoration: none;
  white-space: nowrap;
  border: 1px solid var(--color-border-default);
  border-radius: var(--layout-radius, 6px);
  background: var(--color-bg-surface);
  color: var(--color-fg-default);
  cursor: pointer;
  user-select: none;
  -webkit-user-select: none;
  outline: none;
  transition:
    background-color var(--transition-fast),
    border-color     var(--transition-fast),
    color            var(--transition-fast),
    box-shadow       var(--transition-fast),
    opacity          var(--transition-fast);
}

.btn:hover {
  border-color: var(--color-border-focus);
  background: var(--color-bg-canvas);
}

.btn:active {
  transform: translateY(1px);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.2);
}

.btn:focus-visible {
  box-shadow: 0 0 0 2px var(--color-border-focus);
  border-color: var(--color-border-focus);
}

.btn:disabled,
.btn[aria-disabled="true"] {
  opacity: 0.4;
  pointer-events: none;
  cursor: not-allowed;
}

/* Primary variant */
.btn-primary {
  background: var(--color-bg-brand);
  border-color: var(--color-bg-brand);
  color: #ffffff;
}
.btn-primary:hover {
  filter: brightness(1.1);
  background: var(--color-bg-brand);
}

/* Ghost variant */
.btn-ghost {
  background: transparent;
  border-color: transparent;
}
.btn-ghost:hover {
  background: rgba(128, 128, 128, 0.1);
  border-color: transparent;
}

/* Danger variant */
.btn-danger {
  background: var(--color-state-error);
  border-color: var(--color-state-error);
  color: #ffffff;
}
.btn-danger:hover {
  filter: brightness(1.1);
}

/* Icon-only button */
.btn-icon {
  padding: 5px;
  width: 28px;
  height: 28px;
  border-radius: var(--layout-radius, 6px);
}

/* Small button */
.btn-sm {
  padding: 3px 8px;
  font-size: var(--font-size-xs, 10px);
}

/* Large button */
.btn-lg {
  padding: 8px 18px;
  font-size: var(--font-size-md, 14px);
}


/* ============================================================
   SECTION 15 — TOGGLE BUTTON / PILL SWITCH
   ============================================================ */

/* Pill toggle (on/off) */
.toggle-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  font-size: var(--font-size-xs, 10px);
  font-weight: 700;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  border: 1px solid var(--color-border-default);
  border-radius: 100px; /* pill */
  background: var(--color-bg-surface);
  color: var(--color-fg-muted);
  cursor: pointer;
  user-select: none;
  transition:
    background-color var(--transition-fast),
    border-color     var(--transition-fast),
    color            var(--transition-fast),
    box-shadow       var(--transition-fast);
}

.toggle-btn:hover {
  border-color: var(--color-border-focus);
  color: var(--color-fg-default);
}

.toggle-btn.toggle-active,
.toggle-btn[aria-pressed="true"] {
  background: var(--color-bg-brand);
  border-color: var(--color-bg-brand);
  color: #ffffff;
  box-shadow: 0 0 6px rgba(26, 115, 232, 0.35);
}

/* Tab-style toggle group */
.toggle-group {
  display: inline-flex;
  border: 1px solid var(--color-border-default);
  border-radius: var(--layout-radius, 6px);
  overflow: hidden;
  gap: 0;
}

.toggle-group .toggle-btn {
  border: none;
  border-radius: 0;
  border-right: 1px solid var(--color-border-muted);
}

.toggle-group .toggle-btn:last-child {
  border-right: none;
}


/* ============================================================
   SECTION 16 — INPUT STYLES
   ============================================================ */

/* Base input */
.input {
  display: block;
  width: 100%;
  padding: 5px 8px;
  font-family: var(--font-sans);
  font-size: var(--font-size-sm, 11px);
  color: var(--color-fg-default);
  background: var(--color-bg-canvas);
  border: 1px solid var(--color-border-default);
  border-radius: var(--layout-radius, 6px);
  outline: none;
  line-height: 1.4;
  transition:
    border-color     var(--transition-fast),
    box-shadow       var(--transition-fast),
    background-color var(--transition-slow);
}

.input:hover {
  border-color: var(--color-border-focus);
}

.input:focus {
  border-color: var(--color-border-focus);
  box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
}

.input:disabled {
  opacity: 0.45;
  pointer-events: none;
  background: var(--color-bg-surface);
}

/* Monospace input (for numbers, symbols) */
.input-mono {
  font-family: var(--font-mono);
  letter-spacing: 0.04em;
  font-variant-numeric: tabular-nums;
}

/* Select */
.select {
  appearance: none;
  -webkit-appearance: none;
  padding-right: 24px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none'%3E%3Cpath d='M1 1l4 4 4-4' stroke='%236b7280' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 7px center;
  cursor: pointer;
}

/* Label */
.input-label {
  display: block;
  font-size: var(--font-size-xs, 10px);
  font-weight: 700;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--color-fg-muted);
  margin-bottom: 4px;
}

/* Field group (label + input stack) */
.field {
  display: flex;
  flex-direction: column;
  gap: 4px;
}


/* ============================================================
   SECTION 17 — DISPLAY COMPONENT BASE
   Terminal displays, charts, dropdowns, logs.
   Shares base styles; illumination.css adds the glow.
   ============================================================ */

.display-component,
.terminal-display,
.graph-container,
.chart-container,
.data-log,
.dropdown-panel {
  background: var(--color-bg-canvas);
  border: 1px solid var(--color-border-default);
  border-radius: var(--layout-radius, 6px);
  overflow: hidden;
  transition:
    background-color var(--transition-slow),
    border-color     var(--transition-slow),
    box-shadow       var(--transition-slow);
}

.terminal-display,
.data-log {
  font-family: var(--font-mono);
  font-size: var(--font-size-sm, 11px);
  padding: 8px;
  overflow-y: auto;
  line-height: 1.6;
}

.chart-container,
.graph-container {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  min-height: 0;
}

/* Dropdown panel floater */
.dropdown-panel {
  position: absolute;
  z-index: 500;
  min-width: 160px;
  padding: 4px 0;
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.15),
    0 1px  3px rgba(0, 0, 0, 0.1);
}

.dropdown-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  font-size: var(--font-size-sm, 11px);
  color: var(--color-fg-default);
  cursor: pointer;
  transition:
    background-color var(--transition-fast),
    color            var(--transition-fast);
}

.dropdown-item:hover {
  background: var(--color-bg-canvas);
  color: var(--color-fg-strong);
}

.dropdown-item.item-active {
  background: var(--color-bg-brand);
  color: #ffffff;
}


/* ============================================================
   SECTION 18 — FLEX & GRID UTILITIES
   ============================================================ */

/* Flex helpers */
.flex         { display: flex; }
.flex-col     { display: flex; flex-direction: column; }
.flex-row     { display: flex; flex-direction: row; }
.flex-center  { display: flex; align-items: center; justify-content: center; }
.flex-between { display: flex; align-items: center; justify-content: space-between; }
.flex-wrap    { flex-wrap: wrap; }
.flex-1       { flex: 1 1 auto; }
.flex-none    { flex: none; }
.items-center { align-items: center; }
.items-start  { align-items: flex-start; }
.items-end    { align-items: flex-end; }
.gap-2  { gap: 2px; }
.gap-4  { gap: 4px; }
.gap-6  { gap: 6px; }
.gap-8  { gap: 8px; }
.gap-12 { gap: 12px; }
.gap-18 { gap: 18px; }

/* Overflow helpers */
.overflow-hidden { overflow: hidden; }
.overflow-auto   { overflow: auto; }
.overflow-x-auto { overflow-x: auto; overflow-y: hidden; }
.overflow-y-auto { overflow-y: auto; overflow-x: hidden; }

/* Spacing helpers */
.p-0   { padding: 0; }
.p-4   { padding: 4px; }
.p-6   { padding: 6px; }
.p-8   { padding: 8px; }
.p-12  { padding: 12px; }
.p-18  { padding: 18px; }
.mt-4  { margin-top: 4px; }
.mt-8  { margin-top: 8px; }
.mt-12 { margin-top: 12px; }
.mb-4  { margin-bottom: 4px; }
.mb-8  { margin-bottom: 8px; }
.mb-12 { margin-bottom: 12px; }

/* Visibility */
.hidden        { display: none !important; }
.invisible     { visibility: hidden; }
.opacity-0     { opacity: 0; }
.opacity-50    { opacity: 0.5; }

/* Full dimensions */
.w-full  { width: 100%; }
.h-full  { height: 100%; }
.min-h-0 { min-height: 0; }
.min-w-0 { min-width: 0; }

/* Truncate */
.truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}


/* ============================================================
   SECTION 19 — SEPARATOR / DIVIDER
   ============================================================ */

.divider {
  height: 1px;
  background: var(--color-border-muted);
  border: none;
  margin: 8px 0;
  flex-shrink: 0;
  transition: background-color var(--transition-slow);
}

.divider-v {
  width: 1px;
  align-self: stretch;
  background: var(--color-border-muted);
  flex-shrink: 0;
  transition: background-color var(--transition-slow);
}


/* ============================================================
   SECTION 20 — GLOBAL THEME TRANSITION
   Applied at the root so every element inherits the smoothing
   when the user switches between light/dark/theme presets.
   ============================================================ */

html {
  transition:
    background-color var(--transition-slow),
    color            var(--transition-slow);
}

/* Performance: contain paint for large regions */
.region-main,
.region-lsidebar,
.region-rsidebar {
  contain: layout style;
}

/* ============================================================
   COMPONENT EXTENSIONS
   ============================================================ */

/* .active alias for toggle-active (used across buttons) */
.toggle-btn.active,
.btn.active,
.btn-sm.active {
  background: var(--color-bg-brand);
  border-color: var(--color-bg-brand);
  color: #ffffff;
}

/* Studio selector chunky radio buttons */
.studio-selector {
  display: flex;
  gap: 4px;
  padding: 4px;
  align-items: center;
}

.studio-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 5px 18px;
  font-size: 12px;
  font-weight: 900;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  border: 2px solid var(--color-border-default);
  border-radius: var(--layout-radius);
  background: var(--color-bg-surface);
  color: var(--color-fg-muted);
  cursor: pointer;
  user-select: none;
  transition: all var(--transition-fast);
  position: relative;
  box-shadow: 0 2px 0 rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.15);
}

.studio-btn:hover {
  border-color: var(--color-border-focus);
  color: var(--color-fg-default);
  transform: translateY(-1px);
  box-shadow: 0 3px 0 rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.15);
}

.studio-btn.active,
.studio-btn[aria-selected="true"] {
  background: var(--color-bg-brand);
  border-color: var(--color-bg-brand);
  color: #ffffff;
  transform: translateY(1px);
  box-shadow: 0 1px 0 rgba(0,0,0,0.3), inset 0 2px 4px rgba(0,0,0,0.2);
}

/* DAY/NVG toggle buttons */
.day-nvg-btn {
  padding: 3px 8px;
  font-size: 10px;
  font-weight: 700;
  border: 1px solid var(--color-border-default);
  border-radius: 3px;
  background: var(--color-bg-surface);
  color: var(--color-fg-muted);
  cursor: pointer;
  transition: all var(--transition-fast);
  letter-spacing: 0.05em;
}

.day-nvg-btn.active {
  background: var(--color-bg-brand);
  border-color: var(--color-bg-brand);
  color: white;
}

/* Telemetry bar */
.telemetry-bar {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 3px 12px;
}

.telemetry-item {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 10px;
}

/* Theme buttons container */
.theme-btn {
  font-size: 11px;
  padding: 5px 4px;
  font-weight: 700;
  text-align: center;
  border-radius: 4px;
  cursor: pointer;
  line-height: 1.2;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  transition: opacity 0.15s, transform 0.1s;
  border: 2px solid transparent;
}

.theme-btn:hover { opacity: 0.85; transform: scale(1.03); }
.theme-btn.active { outline: 2px solid var(--color-border-focus); outline-offset: 1px; }

/* Permission dial buttons */
.permission-dial-group {
  display: flex;
  gap: 2px;
}

.perm-btn {
  padding: 2px 6px;
  font-size: 10px;
  font-weight: 700;
  border: 1px solid var(--color-border-default);
  border-radius: 3px;
  background: var(--color-bg-surface);
  color: var(--color-fg-muted);
  cursor: pointer;
  transition: all var(--transition-fast);
  letter-spacing: 0.03em;
}

.perm-btn:hover { border-color: var(--color-border-focus); }

.perm-btn.active[data-perm="auto"] {
  background: var(--color-state-success);
  border-color: var(--color-state-success);
  color: white;
}
.perm-btn.active[data-perm="semi-auto"] {
  background: var(--color-state-warning);
  border-color: var(--color-state-warning);
  color: white;
}
.perm-btn.active[data-perm="full-stop"] {
  background: var(--color-state-error);
  border-color: var(--color-state-error);
  color: white;
}

/* Category buttons in trading studio */
.category-btn {
  white-space: nowrap;
}

/* Fade-in toast animation */
@keyframes fadeInOut {
  0%   { opacity: 0; transform: translateY(10px); }
  15%  { opacity: 1; transform: translateY(0); }
  80%  { opacity: 1; }
  100% { opacity: 0; }
}

/* Studio content visibility */
.studio-content { width: 100%; }


/* ============================================================
   SECTION 21 — LOADING SPINNER (Phase 1/3)
   Used on async buttons (e.g. Connect).
   ============================================================ */

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading-spinner {
  display: inline-block;
  width: 12px;
  height: 12px;
  border: 2px solid rgba(255, 255, 255, 0.35);
  border-top-color: #ffffff;
  border-radius: 50%;
  animation: spin 0.65s linear infinite;
  flex-shrink: 0;
}

.btn.btn-loading {
  pointer-events: none;
  cursor: wait;
  opacity: 0.75;
}


/* ============================================================
   SECTION 22 — FORM VALIDATION STATES (Phase 1/3)
   ============================================================ */

.input.input-invalid {
  border-color: var(--color-state-error) !important;
  box-shadow: 0 0 0 2px rgba(220, 38, 38, 0.18) !important;
}

.input.input-valid {
  border-color: var(--color-state-success) !important;
  box-shadow: 0 0 0 2px rgba(22, 163, 74, 0.15) !important;
}

@keyframes input-shake {
  0%, 100% { transform: translateX(0); }
  20%       { transform: translateX(-5px); }
  40%       { transform: translateX(5px); }
  60%       { transform: translateX(-3px); }
  80%       { transform: translateX(3px); }
}

.input.input-shake {
  animation: input-shake 0.35s ease;
}


/* ============================================================
   SECTION 23 — STUDIO FADE TRANSITION (Phase 3)
   Replacing the hard show/hide with a soft fade-in.
   ============================================================ */

@keyframes studio-fade-in {
  from { opacity: 0; transform: translateY(5px); }
  to   { opacity: 1; transform: translateY(0); }
}

.studio-content.studio-entering {
  animation: studio-fade-in var(--transition-base, 150ms) ease forwards;
}


/* ============================================================
   SECTION 24 — SKIP NAVIGATION (Phase 4)
   Visible only on keyboard focus — screen reader / tab users.
   ============================================================ */

.skip-nav {
  position: fixed;
  top: -120%;
  left: 18px;
  z-index: 9999;
  padding: 8px 16px;
  background: var(--color-bg-brand);
  color: #ffffff;
  border-radius: var(--layout-radius, 6px);
  font-size: var(--font-size-sm, 11px);
  font-weight: 700;
  letter-spacing: 0.08em;
  text-decoration: none;
  white-space: nowrap;
  transition: top var(--transition-fast, 80ms);
}

.skip-nav:focus {
  top: 18px;
  outline: 2px solid #ffffff;
  outline-offset: 3px;
}


/* ============================================================
   SECTION 25 — CURSOR UTILITIES (Phase 2)
   ============================================================ */

/* Rotary dials: vertical drag = value change */
.rotary-dial {
  cursor: ns-resize;
}

.rotary-dial:focus-visible {
  outline: 2px solid var(--color-border-focus);
  outline-offset: 2px;
  border-radius: 50%;
}


/* ============================================================
   SECTION 26 — ACCESSIBILITY: REDUCED MOTION (Phase 7)
   Strips all animations/transitions when the user has
   "Reduce motion" enabled at the OS level.
   ============================================================ */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0s !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0s !important;
    scroll-behavior: auto !important;
  }
}


/* ============================================================
   SECTION 27 — ACCESSIBILITY: HIGH CONTRAST (Phase 7)
   Windows "High Contrast" / Forced Colors mode overrides.
   ============================================================ */

@media (forced-colors: active) {
  .region,
  .card {
    border: 1px solid ButtonText;
  }

  .indicator-light {
    border: 2px solid ButtonText;
    background: ButtonFace;
    box-shadow: none;
  }

  .indicator-light.light-on {
    background: Highlight;
    border-color: Highlight;
  }

  .btn,
  .studio-btn,
  .toggle-btn,
  .perm-btn,
  .day-nvg-btn,
  .btn-sm {
    border: 1px solid ButtonText;
    background: ButtonFace;
    color: ButtonText;
    box-shadow: none;
  }

  .btn:hover,
  .studio-btn:hover,
  .toggle-btn:hover {
    border-color: Highlight;
    color: Highlight;
  }

  .btn.active,
  .studio-btn.active,
  .toggle-btn.active,
  .btn[aria-selected="true"],
  .studio-btn[aria-selected="true"],
  .toggle-btn[aria-pressed="true"],
  .perm-btn.active {
    forced-color-adjust: none;
    background: Highlight;
    color: HighlightText;
    border-color: Highlight;
  }

  .flip-switch-body {
    border: 2px solid ButtonText;
  }

  .input {
    border: 1px solid ButtonText;
    background: Field;
    color: FieldText;
  }

  .input:focus {
    border-color: Highlight;
    outline: 2px solid Highlight;
  }
}


/* ============================================================
   SECTION 28 — FOCUS-VISIBLE: ALL REMAINING INTERACTIVE ELEMENTS
   Ensures every focusable control shows a clear keyboard-focus
   outline. Uses :focus-visible so mouse clicks don't show it.
   ============================================================ */

.toggle-btn:focus-visible,
.day-nvg-btn:focus-visible,
.studio-btn:focus-visible,
.perm-btn:focus-visible,
.btn-sm:focus-visible,
.theme-btn:focus-visible,
.notebook-tool-btn:focus-visible,
.notebook-add-btn:focus-visible,
.notebook-check:focus-visible,
.notebook-delete:focus-visible {
  outline: 2px solid var(--color-border-focus);
  outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.25);
}

/* Flip switches use role="switch" — keyboard focus ring matches dial style */
[role="switch"]:focus-visible {
  outline: 2px solid var(--color-border-focus);
  outline-offset: 3px;
  border-radius: 2px;
}
